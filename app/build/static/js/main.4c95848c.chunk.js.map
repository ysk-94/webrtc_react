{"version":3,"sources":["components/Entry.tsx","config/sw.ts","components/Message.tsx","components/Room.tsx","components/App.tsx","serviceWorker.ts","index.tsx"],"names":["Entry","props","newRoomId","uuidv4","useState","roomId","setRoomId","className","id","type","onChange","e","setUserName","target","value","onNameChange","placeholder","style","marginTop","onRoomIdChange","to","peer","Peer","key","debug","Message","message","setMessage","onClick","sendMessage","Room","isInit","room","localVideoRef","remoteVideoRefs","remoteStreams","userName","match","params","React","createRef","state","remoteVideos","messages","open","alert","this","navigator","mediaDevices","getUserMedia","audio","video","localStream","current","srcObject","play","catch","console","error","joinRoom","mode","stream","once","on","peerId","Object","assign","push","user","setState","a","newVideo","ref","playsInline","autoPlay","data","parsed","src","JSON","parse","init","keys","forEach","targetNode","getAudioTracks","track","enabled","getVideoTracks","send","stringify","values","map","wordWrap","padding","muted","color","width","height","toggleMuteAudio","toggleMuteVideo","Component","App","exact","path","render","Boolean","window","location","hostname","ReactDOM","StrictMode","document","getElementById","serviceWorker","ready","then","registration","unregister"],"mappings":"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","file":"static/js/main.4c95848c.chunk.js","sourcesContent":["import React, { useState } from 'react';\nimport { Link } from 'react-router-dom';\nimport { v4 as uuidv4 } from 'uuid';\nimport { peer } from '../config/sw';\nimport '../css/Entry.css'\n\ninterface Props {\n  setUserName: (name: string) => void;\n  userName: string;\n}\n\nconst Entry = (props: Props) => {\n  const newRoomId = uuidv4();\n  const [roomId, setRoomId] = useState('');\n\n  /**\n   * RoomId変更\n   */\n  const onRoomIdChange = (e: any) => {\n    setRoomId(e.target.value);\n  };\n\n  /**\n   * ユーザー名変更\n   * @param e \n   */\n  const onNameChange = (e: any) => {\n    props.setUserName(e.target.value);\n  };\n\n  return(\n    <div className='entry'>\n      <div>\n        <h1 className='entry__logo'>INN-STUDIO</h1>\n        <div className='entry__formBox'>\n          <p className='entry__formBody'>INN-STUDIOで遠く離れた人とのビデオ通話を楽しみましょう。</p>\n          <div className='entry__row entry__row--1'>\n          </div>\n          <form className='entry__form'>\n            <div className='entry__row entry__row--flex'>\n              <input className='entry__form__input' id=\"name\" type=\"text\" onChange={e => onNameChange(e)} placeholder='ニックネームを入力'></input>\n              <input style={{marginTop: '8px'}} className='entry__form__input' id=\"roomId\" type=\"text\" onChange={e => onRoomIdChange(e)} placeholder='ROOMIDを入力（JOINのみ）'></input>\n              <p className='entry__note'>※Roomを新規作成する場合、ROOMIDは自動で作成されます。</p>\n              <div className='entry__row'>\n                <Link className='entry__newLink' to={`/rooms/${newRoomId}`}>新規作成</Link>\n                <Link className='entry__joinLink' to={`/rooms/${roomId}`}>JOIN</Link>\n              </div>\n            </div>\n          </form>\n        </div>\n      </div>\n      <p className='copyright'>© 2020 ysk.</p>\n    </div>\n  );\n};\n\nexport default Entry;","import Peer from 'skyway-js';\n\nexport const peer: Peer = new Peer({\n  key: '5630df90-6dd1-4ed9-9585-9469ecd49dd8',\n  debug: 0\n});\n","import React, { useState } from 'react';\n\ninterface Props {\n  sendMessage: (message: string) => void;\n}\n\nconst Message = (props: Props) => {\n  const [message, setMessage] = useState('');\n\n  const onSend = () => {\n    props.sendMessage(message);\n    setMessage('');\n  };\n\n  return(\n    <div className='room__form'>\n      <input \n        id=\"message\"\n        className='room__form__input' \n        type=\"text\" \n        value={message}\n        onChange={e => setMessage(e.target.value)} \n        placeholder='メッセージを入力'></input>\n      <a className='room__form__send' onClick={() => onSend()}>送信</a>\n    </div>\n  );\n};\n\nexport default Message;","import React from 'react';\nimport { peer } from '../config/sw';\nimport Message from './Message';\nimport '../css/Room.css';\nimport { Link } from 'react-router-dom';\n\ninterface Props {\n  match: {\n    params: {\n      roomId: string\n    }\n  };\n  userName: string;\n};\n\ninterface State {\n  remoteVideos: any;\n  messages: {\n    user: string\n    message: string\n  }[]\n}\n\nclass Room extends React.Component<Props, State> {\n  private isInit: boolean;\n  private room: any;\n  private roomId: string;\n  private localVideoRef: any;\n  private remoteVideoRefs: any;\n  private remoteStreams: any;\n  private userName: any;\n\n  constructor(props: Props) {\n    super(props);\n    this.isInit = false;\n    // RoomID\n    this.roomId = this.props.match.params.roomId;\n    // LocalのVideo\n    this.localVideoRef = React.createRef();\n    // RemoteのVideoRef\n    this.remoteVideoRefs = {};\n    // RemoteのStreams\n    this.remoteStreams = {};    \n    // state\n    this.state = {\n      remoteVideos: [],\n      messages: []\n    };\n    // ユーザー\n    if (props.userName === '' || !props.userName) {\n      this.userName = 'ユーザー';\n    } else {\n      this.userName = props.userName;\n    }\n  };\n\n  /**\n   * Join\n   */\n  async init() {\n    // peerがシナジリングサーバーに接続できていなかったら処理しない\n    if (!peer.open) {\n      alert('サーバー未接続エラー');\n      return;\n    } else {\n      this.isInit = true;\n    }\n\n    // Local Stream\n    const localStream = await navigator.mediaDevices.getUserMedia({\n      audio: true,\n      video: true\n    });\n    this.localVideoRef.current.srcObject = localStream;\n    await this.localVideoRef.current.play().catch(console.error);\n\n    // Roomに接続\n    const room = peer.joinRoom(this.roomId, {\n      mode: 'sfu',\n      stream: localStream\n    });\n\n    // 接続時\n    room.once('open', () => {\n      alert(`Room: ${this.roomId} へようこそ`);\n    });\n\n    // ユーザージョイン\n    room.on('peerJoin', peerId => {\n      const messages = Object.assign([], this.state.messages);\n      messages.push({\n        user: 'SYSTEM',\n        message: `新規ユーザーが参加しました。`\n      });\n      this.setState({messages: messages});\n    });\n\n    // 新しく入ってきたユーザーのストリーム表示\n    room.on('stream', async (stream) => {\n      // Refを追加\n      this.remoteVideoRefs[stream.peerId] = React.createRef();\n\n      const newVideo = (\n        <video\n          id={stream.peerId}\n          key={stream.peerId}\n          ref={this.remoteVideoRefs[stream.peerId]} // 今回追加したrefを指定\n          playsInline={true}\n          autoPlay\n          ></video>);\n\n      // StreamをpeerIdに紐づけて保管\n      this.remoteStreams[stream.peerId] = stream;\n      // VideoタグをpeerIdに紐づけてStateに保管\n      const remoteVideos = Object.assign({}, this.state.remoteVideos);\n      remoteVideos[stream.peerId] = newVideo;\n      this.setState({\n        remoteVideos: remoteVideos,\n      });\n    });\n\n    // 他のユーザーが退出したとき\n    room.on('peerLeave', (peerId) => {\n      // this.remoteVideoRefs[peerId].current.srcObject.getTracks().forEace((track: any) => track.stop());\n      // this.remoteVideoRefs[peerId].current.srcObject = null;\n      const remoteVideos = Object.assign({}, this.state.remoteVideos);\n      remoteVideos[peerId] = null;\n      this.setState({\n        remoteVideos: remoteVideos,\n      });\n    });\n\n    // メッセージ送信\n    room.on('data', ({ data, src }) => {\n      const parsed = JSON.parse(data);\n      const messages = Object.assign([], this.state.messages);\n      messages.push({\n        user: parsed.user,\n        message: parsed.message\n      });\n      this.setState({messages: messages});\n    });\n\n\n    // 自分が退出したとき\n    room.once('close', () => {\n      this.setState({\n        remoteVideos: null\n      });\n    });\n\n    this.room = room;\n\n    peer.on('error', console.error);\n  };\n\n  componentDidMount() {\n    if (!this.isInit) {\n      this.init();\n    }\n  }\n\n  componentDidUpdate() {\n    // すべてのリモートビデオのsrcObjectをチェック\n    Object.keys(this.remoteVideoRefs).forEach((key: string) => {\n      const targetNode = this.remoteVideoRefs[key].current;\n      if (targetNode && !targetNode.srcObject) {\n        targetNode.srcObject = this.remoteStreams[key];\n      }\n    });\n  }\n\n  // Roomから離れたとき\n  componentWillUnmount() {\n    // this.room.close();\n  }\n\n  // 音声ミュート\n  toggleMuteAudio(e: any) {\n    this.localVideoRef.current.srcObject.getAudioTracks().forEach((track: any) => {\n      track.enabled = !track.enabled;\n      if (track.enabled) {\n        e.target.src = '/img/mic.png';\n      } else {\n        e.target.src = '/img/mic--muted.png';\n      }\n    });\n  }\n\n  // 映像ミュート\n  toggleMuteVideo(e: any) {\n    this.localVideoRef.current.srcObject.getVideoTracks().forEach((track: any) => {\n      track.enabled = !track.enabled;\n      if (track.enabled) {\n        e.target.src = '/img/movie.png';\n      } else {\n        e.target.src = '/img/movie--muted.png';\n      }\n    });\n  }\n\n\n  /**\n   * Message送信\n   */\n  sendMessage(message: string) {\n    const data = {\n      user: this.userName,\n      message: message\n    };\n    this.room.send(JSON.stringify(data));\n\n    const messages = Object.assign([], this.state.messages);\n      messages.push({\n        user: 'me',\n        message: message\n      });\n    this.setState({messages: messages});\n  }\n\n  render() {\n    const remoteVideos = this.state.remoteVideos? Object.values(this.state.remoteVideos) : null;\n    const messages = this.state.messages.map((message) => <p style={{wordWrap: 'break-word', padding: '0 12px'}}>{message.user}: {message.message}</p>)\n\n    return(\n      <div className='room'>\n        <div className='room__remoteVideos'>\n          <video\n            id=\"localStream\"\n            ref={this.localVideoRef}\n            muted\n            playsInline={true}\n            ></video>\n          {remoteVideos}\n        </div>\n        <div className='room__footer'>\n          <h2 style={{color: '#333', padding: '12px'}}>ROOMID:<br></br> {this.roomId}</h2>\n          <div className='room_messages'>{messages}</div>\n          <Message sendMessage={(message) => this.sendMessage(message)} />\n          <div className='room__manuBox'>\n            <img width='30' height='30' src='/img/mic.png' onClick={(e) => this.toggleMuteAudio(e)}></img>\n            <img width='30' height='30' src='/img/movie.png' onClick={(e) => this.toggleMuteVideo(e)}></img>\n            <Link className='room__close' to='/'>接続終了</Link>\n          </div>\n        </div>\n      </div>\n    );\n  }\n};\n\nexport default Room;","import React, { useState } from 'react';\nimport { BrowserRouter, Route } from \"react-router-dom\";\nimport Entry from './Entry';\nimport Room from './Room';\n\nconst App = () => {\n  const [userName, setUserName] = useState('');\n\n  return (\n    <>\n      <BrowserRouter>\n        <Route exact path='/' render={() => <Entry setUserName={setUserName} userName={userName} />} />\n        <Route path='/rooms/:roomId' render={(props) => <Room {...props} userName={userName} />} />\n      </BrowserRouter>\n    </>\n  );\n}\n\nexport default App;\n","// This optional code is used to register a service worker.\n// register() is not called by default.\n\n// This lets the app load faster on subsequent visits in production, and gives\n// it offline capabilities. However, it also means that developers (and users)\n// will only see deployed updates on subsequent visits to a page, after all the\n// existing tabs open on the page have been closed, since previously cached\n// resources are updated in the background.\n\n// To learn more about the benefits of this model and instructions on how to\n// opt-in, read https://bit.ly/CRA-PWA\n\nconst isLocalhost = Boolean(\n  window.location.hostname === 'localhost' ||\n    // [::1] is the IPv6 localhost address.\n    window.location.hostname === '[::1]' ||\n    // 127.0.0.0/8 are considered localhost for IPv4.\n    window.location.hostname.match(\n      /^127(?:\\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/\n    )\n);\n\ntype Config = {\n  onSuccess?: (registration: ServiceWorkerRegistration) => void;\n  onUpdate?: (registration: ServiceWorkerRegistration) => void;\n};\n\nexport function register(config?: Config) {\n  if (process.env.NODE_ENV === 'production' && 'serviceWorker' in navigator) {\n    // The URL constructor is available in all browsers that support SW.\n    const publicUrl = new URL(\n      process.env.PUBLIC_URL,\n      window.location.href\n    );\n    if (publicUrl.origin !== window.location.origin) {\n      // Our service worker won't work if PUBLIC_URL is on a different origin\n      // from what our page is served on. This might happen if a CDN is used to\n      // serve assets; see https://github.com/facebook/create-react-app/issues/2374\n      return;\n    }\n\n    window.addEventListener('load', () => {\n      const swUrl = `${process.env.PUBLIC_URL}/service-worker.js`;\n\n      if (isLocalhost) {\n        // This is running on localhost. Let's check if a service worker still exists or not.\n        checkValidServiceWorker(swUrl, config);\n\n        // Add some additional logging to localhost, pointing developers to the\n        // service worker/PWA documentation.\n        navigator.serviceWorker.ready.then(() => {\n          console.log(\n            'This web app is being served cache-first by a service ' +\n              'worker. To learn more, visit https://bit.ly/CRA-PWA'\n          );\n        });\n      } else {\n        // Is not localhost. Just register service worker\n        registerValidSW(swUrl, config);\n      }\n    });\n  }\n}\n\nfunction registerValidSW(swUrl: string, config?: Config) {\n  navigator.serviceWorker\n    .register(swUrl)\n    .then(registration => {\n      registration.onupdatefound = () => {\n        const installingWorker = registration.installing;\n        if (installingWorker == null) {\n          return;\n        }\n        installingWorker.onstatechange = () => {\n          if (installingWorker.state === 'installed') {\n            if (navigator.serviceWorker.controller) {\n              // At this point, the updated precached content has been fetched,\n              // but the previous service worker will still serve the older\n              // content until all client tabs are closed.\n              console.log(\n                'New content is available and will be used when all ' +\n                  'tabs for this page are closed. See https://bit.ly/CRA-PWA.'\n              );\n\n              // Execute callback\n              if (config && config.onUpdate) {\n                config.onUpdate(registration);\n              }\n            } else {\n              // At this point, everything has been precached.\n              // It's the perfect time to display a\n              // \"Content is cached for offline use.\" message.\n              console.log('Content is cached for offline use.');\n\n              // Execute callback\n              if (config && config.onSuccess) {\n                config.onSuccess(registration);\n              }\n            }\n          }\n        };\n      };\n    })\n    .catch(error => {\n      console.error('Error during service worker registration:', error);\n    });\n}\n\nfunction checkValidServiceWorker(swUrl: string, config?: Config) {\n  // Check if the service worker can be found. If it can't reload the page.\n  fetch(swUrl, {\n    headers: { 'Service-Worker': 'script' }\n  })\n    .then(response => {\n      // Ensure service worker exists, and that we really are getting a JS file.\n      const contentType = response.headers.get('content-type');\n      if (\n        response.status === 404 ||\n        (contentType != null && contentType.indexOf('javascript') === -1)\n      ) {\n        // No service worker found. Probably a different app. Reload the page.\n        navigator.serviceWorker.ready.then(registration => {\n          registration.unregister().then(() => {\n            window.location.reload();\n          });\n        });\n      } else {\n        // Service worker found. Proceed as normal.\n        registerValidSW(swUrl, config);\n      }\n    })\n    .catch(() => {\n      console.log(\n        'No internet connection found. App is running in offline mode.'\n      );\n    });\n}\n\nexport function unregister() {\n  if ('serviceWorker' in navigator) {\n    navigator.serviceWorker.ready\n      .then(registration => {\n        registration.unregister();\n      })\n      .catch(error => {\n        console.error(error.message);\n      });\n  }\n}\n","import React from 'react';\nimport ReactDOM from 'react-dom';\nimport './index.css';\nimport App from './components/App';\nimport * as serviceWorker from './serviceWorker';\n\nReactDOM.render(\n  <React.StrictMode>\n    <App />\n  </React.StrictMode>,\n  document.getElementById('root')\n);\n\n// If you want your app to work offline and load faster, you can change\n// unregister() to register() below. Note this comes with some pitfalls.\n// Learn more about service workers: https://bit.ly/CRA-PWA\nserviceWorker.unregister();\n"],"sourceRoot":""}